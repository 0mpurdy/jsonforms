<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>ReactiveForms</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- <link rel="icon" type="image/x-icon" href="favicon.ico"> -->
  <script src="native-shim.js"></script>
  <!-- <script src="dist/json-forms.js"></script> -->
  <script src="assets/bundle.js"></script>
  <style>
    .tree-layout {display: flex; flex-direction: row;}
    .tree-master {flex:1; border:1px solid;}
    .tree-detail {flex:3; border:1px solid;}
    .tree-master ul {list-style-type: none;}
    .tree-master li {min-height: 1em; border:1px solid;}
    .vertical-layout {display: flex; flex-direction: column;}
    .vertical-layout > * {flex: 1;}
    .hide {display: none;}
  </style>
</head>
<body>
<div>
  <button onclick="change()">Change</button>
</div>
<script>
    var body = document.getElementsByTagName('body')[0];
    var jsonForms = document.createElement('json-forms');

    var dataschema = {
        "type": "object",
        "properties": {
            "name": {
                "type": "string",
                "minLength":3
            },
            "description": {
                "type": "string"
            },
            "done": {
                "type": "boolean"
            },
            "due_date": {
                "type": "string",
                "format": "date"
            },
            "rating": {
                "type": "integer",
                "maximum": 5
            },
            "recurrence": {
                "type": "string",
                "enum":["Never","Daily","Weekly","Monthly"]
            },
            "recurrence_interval":{
                "type": "integer"
            },
            "coordinates": {
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "x": { "type": "integer" },
                        "y": { "type": "integer" }
                    },
                    "required": ["x", "y"]
                }
            }
        },
        "required": ["name", "rating"]
    };

    var uischema = {
        "type": "VerticalLayout",
        "elements": [
            {
                "type": "Control",
                "scope": {
                    "$ref": "#/properties/name"
                }
            },
            {
                "type": "Control",
                "label": false,
                "scope": {
                    "$ref": "#/properties/done"
                }
            },
            {
                "type": "Control",
                "scope": {
                    "$ref": "#/properties/description"
                },
                "options": {
                    "multi":true
                }
            },
            {
                "type": "Control",
                "scope": {
                    "$ref": "#/properties/due_date"
                }
            },
            {
                "type": "Control",
                "scope": {
                    "$ref": "#/properties/rating"
                }
            },
            {
                "type": "Control",
                "scope": {
                    "$ref": "#/properties/recurrence"
                }
            },
            {
                "type": "ArrayControl",
                "scope": {
                    "$ref": "#/properties/coordinates"
                }
            },
            {
                "type": "Control",
                "scope": {
                    "$ref": "#/properties/recurrence_interval"
                },
                "rule": {
                    "effect": "HIDE",
                    "condition": {
                        "scope": {
                            "$ref": "#/properties/recurrence"
                        },
                        "expectedValue": "Never"
                    }
                }
            }
        ]
    };

    var data = {
        "name": "Send email to Adriana",
        "description": "Confirm if you have passed the subject\nHerby ...",
        "done": true,
        "recurrence":"Daily",
        "coordinates": [
            {
                "x": 3,
                "y": 4
            },
            {
                "x": 11,
                "y": 12
            }
        ]
    };

    var uischema2 = {
        "type": "VerticalLayout",
        "elements": [
            {
                "type": "Control",
                "scope": {
                    "$ref": "#/properties/name"
                }
            },
            {
                "type": "Control",
                "scope": {
                    "$ref": "#/properties/recurrence"
                }
            },
            {
                "type": "Control",
                "scope": {
                    "$ref": "#/properties/recurrence_interval"
                },
                "rule": {
                    "effect": "HIDE",
                    "condition": {
                        "scope": {
                            "$ref": "#/properties/recurrence"
                        },
                        "expectedValue": "Never"
                    }
                }
            }
        ]
    };
    jsonForms.data=data;
    jsonForms.uiSchema=uischema;
    jsonForms.dataSchema=dataschema;
    body.appendChild(jsonForms);
    function change() {
        jsonForms.uiSchema = uischema2;
    }
</script>
</body>
</html>
